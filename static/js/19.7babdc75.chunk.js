"use strict";(self.webpackChunkvulpes_storage=self.webpackChunkvulpes_storage||[]).push([[19],{3019:function(e,n,r){r.r(n),r.d(n,{default:function(){return x}});var t=r(5861),c=r(9439),s=r(4687),a=r.n(s),l=r(2791),i={},u=r(1089),o=r(184),d=function(){var e=(0,l.useRef)(null),n=(0,l.useRef)(null),r=(0,l.useState)([]),s=(0,c.Z)(r,2),d=s[0],h=s[1],x=(0,l.useState)(""),f=(0,c.Z)(x,2),v=f[0],j=f[1],p=(0,l.useState)(null),m=(0,c.Z)(p,2),b=m[0],k=m[1],g=(0,l.useRef)(new u.BrowserMultiFormatReader);(0,l.useEffect)((function(){var e=g.current;return e.listVideoInputDevices().then((function(e){h(e),e.length>0&&j(e[0].deviceId)})),function(){e.reset()}}),[]);return(0,o.jsxs)("div",{className:i.container,children:[(0,o.jsx)("div",{className:i.scanBlock,children:(0,o.jsx)("video",{ref:e,className:i.videoArea})}),(0,o.jsxs)("div",{className:i.buttonsBlock,children:[(0,o.jsx)("button",{className:i.button,onClick:function(){v&&g.current.decodeFromVideoDevice(v,e.current,function(){var e=(0,t.Z)(a().mark((function e(n,r){var t,c,s,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=23;break}return e.prev=1,e.next=4,fetch("/api/products/".concat(n.text));case 4:if(t=e.sent,!(c=t.headers.get("content-type"))||!c.includes("application/json")){e.next=13;break}return e.next=9,t.json();case 9:s=e.sent,200===t.status?k({name:s.name,article:s.article,barcode:s.barcode}):k({error:s.message}),e.next=17;break;case 13:return e.next=15,t.text();case 15:l=e.sent,console.error("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 JSON:",l);case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.error(e.t0),k({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443"});case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(n,r){return e.apply(this,arguments)}}())},children:"Start"}),(0,o.jsx)("button",{className:i.button,onClick:function(){g.current.reset(),k(null)},children:"Reset"})]}),(0,o.jsxs)("div",{className:i.scanBlock,children:[(0,o.jsx)("label",{htmlFor:"sourceSelect",children:"Change video source:"}),(0,o.jsx)("select",{ref:n,id:"sourceSelect",value:v,onChange:function(e){return j(e.target.value)},children:d.map((function(e){return(0,o.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(e.deviceId)},e.deviceId)}))})]}),(0,o.jsxs)("div",{className:i.scanBlock,children:[(0,o.jsx)("label",{children:"Result:"}),b?b.error?(0,o.jsx)("p",{children:b.error}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:["\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435: ",b.name]}),(0,o.jsxs)("p",{children:["\u0410\u0440\u0442\u0438\u043a\u0443\u043b: ",b.article]}),(0,o.jsxs)("p",{children:["\u0428\u0442\u0440\u0438\u0445\u043a\u043e\u0434: ",b.barcode]})]}):(0,o.jsx)("p",{children:"\u041d\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430"})]})]})},h=r(3050);function x(){return(0,o.jsx)(h.B6,{children:(0,o.jsxs)("div",{children:[(0,o.jsx)(h.ql,{children:(0,o.jsx)("title",{children:"Scanner"})}),(0,o.jsx)(d,{})]})})}}}]);
//# sourceMappingURL=19.7babdc75.chunk.js.map