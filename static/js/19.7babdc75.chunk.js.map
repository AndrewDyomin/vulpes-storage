{"version":3,"file":"static/js/19.7babdc75.chunk.js","mappings":"sNACA,GAAiB,E,mBCGJA,EAAmB,WAC9B,IAAMC,GAAWC,EAAAA,EAAAA,QAAO,MAClBC,GAAYD,EAAAA,EAAAA,QAAO,MACzB,GAA8BE,EAAAA,EAAAA,UAAS,IAAvC,eAAOC,EAAP,KAAgBC,EAAhB,KACA,GAAgDF,EAAAA,EAAAA,UAAS,IAAzD,eAAOG,EAAP,KAAyBC,EAAzB,KACA,GAA4BJ,EAAAA,EAAAA,UAAS,MAArC,eAAOK,EAAP,KAAeC,EAAf,KAEMC,GAAaT,EAAAA,EAAAA,QAAO,IAAIU,EAAAA,2BAE9BC,EAAAA,EAAAA,YAAU,WACV,IAAMC,EAASH,EAAWI,QAS1B,OAPAD,EAAOE,wBAAwBC,MAAK,SAAAC,GAClCZ,EAAWY,GACPA,EAAkBC,OAAS,GAC7BX,EAAoBU,EAAkB,GAAGE,SAE5C,IAEM,WACLN,EAAOO,OACR,CACF,GAAE,IA4CD,OACE,iBAAKC,UAAWC,EAAAA,UAAhB,WACE,gBAAKD,UAAWC,EAAAA,UAAhB,UACE,kBAAOC,IAAKvB,EAAUqB,UAAWC,EAAAA,eAGnC,iBAAKD,UAAWC,EAAAA,aAAhB,WACE,mBAAQD,UAAWC,EAAAA,OAAYE,QAjDnB,WACXlB,GAELI,EAAWI,QAAQW,sBACjBnB,EACAN,EAASc,QAFX,mCAGE,WAAON,EAAQkB,GAAf,iFACMlB,EADN,0CAGwBmB,MAAM,iBAAD,OAAkBnB,EAAOoB,OAHtD,UAGYC,EAHZ,SAIYC,EAAcD,EAAIE,QAAQC,IAAI,mBAEjBF,EAAYG,SAAS,oBAN9C,iCAO2BJ,EAAIK,OAP/B,OAOcC,EAPd,OAS2B,MAAfN,EAAIO,OACN3B,EAAU,CACR4B,KAAMF,EAAKE,KACXC,QAASH,EAAKG,QACdC,QAASJ,EAAKI,UAGhB9B,EAAU,CAAE+B,MAAOL,EAAKM,UAhBlC,yCAmB2BZ,EAAID,OAnB/B,QAmBcA,EAnBd,OAoBQc,QAAQF,MAAM,+FAA0BZ,GApBhD,0DAuBMc,QAAQF,MAAR,MACA/B,EAAU,CAAE+B,MAAO,sIAxBzB,0DAHF,wDAgCD,EAcK,oBACA,mBAAQnB,UAAWC,EAAAA,OAAYE,QAbpB,WACfd,EAAWI,QAAQM,QACnBX,EAAU,KACX,EAUK,uBAGF,iBAAKY,UAAWC,EAAAA,UAAhB,WACE,kBAAOqB,QAAQ,eAAf,mCACA,mBACEpB,IAAKrB,EACL0C,GAAG,eACHC,MAAOvC,EACPwC,SAAU,SAAAC,GAAC,OAAIxC,EAAoBwC,EAAEC,OAAOH,MAAjC,EAJb,SAMGzC,EAAQ6C,KAAI,SAAAC,GAAM,OACjB,mBAA8BL,MAAOK,EAAO/B,SAA5C,SACG+B,EAAOC,OAAP,iBAA0BD,EAAO/B,WADvB+B,EAAO/B,SADH,UAQvB,iBAAKE,UAAWC,EAAAA,UAAhB,WACE,uCACCd,EACCA,EAAOgC,OACL,uBAAIhC,EAAOgC,SAEX,iCACE,8EAAchC,EAAO6B,SACrB,wEAAa7B,EAAO8B,YACpB,8EAAc9B,EAAO+B,eAIzB,gHAKT,E,UC7GgB,SAASa,IAItB,OACA,SAAC,KAAD,WACE,4BACE,SAAC,KAAD,WACE,0CAEF,SAACrD,EAAD,QAIL,C","sources":["components/Scanner/ProductByBarcode/ProductByBarcode.module.css","components/Scanner/ProductByBarcode/ProductByBarcode.js","pages/Scanner.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {};","import { useEffect, useRef, useState } from 'react';\nimport css from './ProductByBarcode.module.css';\nimport { BrowserMultiFormatReader } from '@zxing/library';\n\nexport const ProductByBarcode = () => {\n  const videoRef = useRef(null);\n  const selectRef = useRef(null);\n  const [devices, setDevices] = useState([]);\n  const [selectedDeviceId, setSelectedDeviceId] = useState('');\n  const [result, setResult] = useState(null);\n\n  const codeReader = useRef(new BrowserMultiFormatReader());\n\n  useEffect(() => {\n  const reader = codeReader.current;\n\n  reader.listVideoInputDevices().then(videoInputDevices => {\n    setDevices(videoInputDevices);\n    if (videoInputDevices.length > 0) {\n      setSelectedDeviceId(videoInputDevices[0].deviceId);\n    }\n  });\n\n  return () => {\n    reader.reset();\n  };\n}, []);\n\n  const startScan = () => {\n    if (!selectedDeviceId) return;\n\n    codeReader.current.decodeFromVideoDevice(\n      selectedDeviceId,\n      videoRef.current,\n      async (result, err) => {\n        if (result) {\n          try {\n            const res = await fetch(`/api/products/${result.text}`);\n            const contentType = res.headers.get('content-type');\n\n            if (contentType && contentType.includes('application/json')) {\n              const data = await res.json();\n\n              if (res.status === 200) {\n                setResult({\n                  name: data.name,\n                  article: data.article,\n                  barcode: data.barcode,\n                });\n              } else {\n                setResult({ error: data.message });\n              }\n            } else {\n              const text = await res.text();\n              console.error('Сервер вернул не JSON:', text);\n            }\n          } catch (error) {\n            console.error(error);\n            setResult({ error: 'Ошибка запроса к серверу' });\n          }\n        }\n      }\n    );\n  };\n\n  const stopScan = () => {\n    codeReader.current.reset();\n    setResult(null);\n  };\n\n  return (\n    <div className={css.container}>\n      <div className={css.scanBlock}>\n        <video ref={videoRef} className={css.videoArea} />\n      </div>\n\n      <div className={css.buttonsBlock}>\n        <button className={css.button} onClick={startScan}>Start</button>\n        <button className={css.button} onClick={stopScan}>Reset</button>\n      </div>\n\n      <div className={css.scanBlock}>\n        <label htmlFor=\"sourceSelect\">Change video source:</label>\n        <select\n          ref={selectRef}\n          id=\"sourceSelect\"\n          value={selectedDeviceId}\n          onChange={e => setSelectedDeviceId(e.target.value)}\n        >\n          {devices.map(device => (\n            <option key={device.deviceId} value={device.deviceId}>\n              {device.label || `Camera ${device.deviceId}`}\n            </option>\n          ))}\n        </select>\n      </div>\n\n      <div className={css.scanBlock}>\n        <label>Result:</label>\n        {result ? (\n          result.error ? (\n            <p>{result.error}</p>\n          ) : (\n            <>\n              <p>Название: {result.name}</p>\n              <p>Артикул: {result.article}</p>\n              <p>Штрихкод: {result.barcode}</p>\n            </>\n          )\n        ) : (\n          <p>Нет результата</p>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { ProductByBarcode } from '../components/Scanner/ProductByBarcode/ProductByBarcode';\nimport { Helmet, HelmetProvider } from 'react-helmet-async';\n// import { useSelector } from 'react-redux';\n// import { selectUser } from '../redux/auth/selectors';\n\n  \n  export default function Home() {\n\n    // const user = useSelector(selectUser);\n\n    return (\n    <HelmetProvider>\n      <div>\n        <Helmet>\n          <title>Scanner</title>\n        </Helmet>\n        <ProductByBarcode />\n      </div>\n    </HelmetProvider>\n    );\n  }"],"names":["ProductByBarcode","videoRef","useRef","selectRef","useState","devices","setDevices","selectedDeviceId","setSelectedDeviceId","result","setResult","codeReader","BrowserMultiFormatReader","useEffect","reader","current","listVideoInputDevices","then","videoInputDevices","length","deviceId","reset","className","css","ref","onClick","decodeFromVideoDevice","err","fetch","text","res","contentType","headers","get","includes","json","data","status","name","article","barcode","error","message","console","htmlFor","id","value","onChange","e","target","map","device","label","Home"],"sourceRoot":""}