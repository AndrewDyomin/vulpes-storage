"use strict";(self.webpackChunkvulpes_storage=self.webpackChunkvulpes_storage||[]).push([[222],{1448:function(n,e,t){t.d(e,{m:function(){return f}});var c=t(5861),r=t(9439),o=t(4687),a=t.n(o),i=t(2791),s={container:"BarcodeScanner_container__zdOxt",scanBlock:"BarcodeScanner_scanBlock__MR5A0",videoArea:"BarcodeScanner_videoArea__AA2r4",hide:"BarcodeScanner_hide__qqbBN",modalArea:"BarcodeScanner_modalArea__9PFQN",modalImage:"BarcodeScanner_modalImage__0uUA6",button:"BarcodeScanner_button__kNses"},l=t(1089),u=t(5612),d=t(4420),h=t(9654),p=t(9230),v=t(184),f=(0,i.forwardRef)((function(n,e){var t=n.setLastResult,o=(0,p.$G)().t,f=(0,d.I0)(),m=(0,d.v9)(h.K),x=(0,i.useRef)(null),_=(0,i.useRef)(null),j=(0,i.useState)([]),g=(0,r.Z)(j,2),b=g[0],y=g[1],k=(0,i.useState)(""),C=(0,r.Z)(k,2),N=C[0],I=C[1],S=(0,i.useState)(null),B=(0,r.Z)(S,2),A=B[0],Z=B[1],L=(0,i.useState)(!1),w=(0,r.Z)(L,2),O=w[0],F=w[1],R=(0,i.useRef)(new l.BrowserMultiFormatReader);(0,i.useEffect)((function(){var n=R.current;return navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return n.listVideoInputDevices()})).then((function(n){y(n),n.length>0&&I(n[0].deviceId)})).catch((function(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435:",n)})),function(){n.reset()}}),[]),(0,i.useImperativeHandle)(e,(function(){return{startScan:M,stopScan:U}}));var M=function(){F(!0),N&&R.current.decodeFromVideoDevice(N,x.current,function(){var n=(0,c.Z)(a().mark((function n(e,c){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e)try{"H"!==(null===e||void 0===e?void 0:e.text[0])&&(t(e.text),f((0,u.BD)(e.text)))}catch(c){console.error(c),Z({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443"})}case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},U=function(){F(!1),R.current.reset(),Z(null)};return(0,i.useEffect)((function(){m&&m.article&&U(),null===m&&U()}),[m,A]),(0,v.jsxs)("div",{className:s.container,children:[(0,v.jsx)("div",{className:s.scanBlock,children:(0,v.jsx)("video",{ref:x,className:O?s.videoArea:s.hide})}),(0,v.jsxs)("div",{className:s.buttonsBlock,children:[(0,v.jsx)("button",{className:s.button,onClick:M,children:o("start")}),(0,v.jsx)("button",{className:s.button,onClick:U,children:o("reset")})]}),(0,v.jsxs)("div",{className:s.scanBlock,children:[(0,v.jsxs)("label",{htmlFor:"sourceSelect",children:[o("change video source"),":"]}),(0,v.jsx)("select",{ref:_,id:"sourceSelect",value:N,onChange:function(n){return I(n.target.value)},children:b.map((function(n){return(0,v.jsx)("option",{value:n.deviceId,children:n.label||"Camera ".concat(n.deviceId)},n.deviceId)}))})]})]})}))},381:function(n,e,t){t.d(e,{N:function(){return l}});var c=t(3439),r=t(7948),o=t.n(r),a="PopUp_modalCloseButton__m06-1",i="PopUp_menuIcon__5-11v",s=t(184),l=function(n){var e=n.isOpen,t=n.close,r=n.body;return(0,s.jsxs)(o(),{isOpen:e,onRequestClose:t,style:{overlay:{backgroundColor:"rgba(9, 9, 9, 0.75)",position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",minWidth:"300px",maxWidth:"80%",width:"auto",maxHeight:"80%",padding:"50px 20px",borderRadius:"12px",border:"2px solid black",backgroundColor:"FFF",transition:"top 0.3s ease-in-out"}},ariaHideApp:!1,children:[(0,s.jsx)("button",{className:a,type:"button",onClick:t,children:(0,s.jsx)("svg",{className:i,children:(0,s.jsx)("use",{href:"".concat(c.Z,"#icon-close-circle")})})}),r]})}},222:function(n,e,t){t.r(e),t.d(e,{default:function(){return Z}});var c=t(7762),r=t(5861),o=t(3433),a=t(9439),i=t(4687),s=t.n(i),l={listWrapper:"InventoryCheckList_listWrapper__ZmVhv",controlArea:"InventoryCheckList_controlArea__qzRVJ",modeButtons:"InventoryCheckList_modeButtons__S5Uyv",addButton:"InventoryCheckList_addButton__GF6NK",selectButton:"InventoryCheckList_selectButton__TSjrs",activeSelect:"InventoryCheckList_activeSelect__NlVrU",addArtBtn:"InventoryCheckList_addArtBtn__jDfjx",modalArea:"InventoryCheckList_modalArea__P1CSU",modalImage:"InventoryCheckList_modalImage__eAl2A",button:"InventoryCheckList_button__apVqB",countArea:"InventoryCheckList_countArea__B0ih7",countInput:"InventoryCheckList_countInput__dfopf",countAddBtn:"InventoryCheckList_countAddBtn__TlZrB",addListArea:"InventoryCheckList_addListArea__p0QVr",list:"InventoryCheckList_list__J6D9u",listItem:"InventoryCheckList_listItem__UnQTL",selectedItem:"InventoryCheckList_selectedItem__D27GP",link:"InventoryCheckList_link__MUYxS",count:"InventoryCheckList_count__So13G",notFoundArea:"InventoryCheckList_notFoundArea__XNR+b",combineButton:"InventoryCheckList_combineButton__kZMfo"},u=t(4270),d=t(9536),h=t(6546),p=t(478),v=t(2791),f=t(1448),m=t(9654),x=t(9567),_=t(4723),j=t(3600),g=t(4217),b=t(4420),y=t(381),k=t(5218),C=t(1087),N=t(9230),I=t(5294),S=t(184),B=function(){var n,e,t=(0,N.$G)().t,i=(0,b.I0)(),B=(0,b.v9)(m.K),A=(0,b.v9)(g.dy),Z=(0,b.v9)(x.N),L=(0,b.v9)(x.W),w=(0,v.useRef)(),O=(0,v.useState)(!1),F=(0,a.Z)(O,2),R=F[0],M=F[1],U=(0,v.useState)(!1),D=(0,a.Z)(U,2),z=D[0],E=D[1],P=(0,v.useState)([]),V=(0,a.Z)(P,2),q=V[0],H=V[1],W=(0,v.useState)(!1),G=(0,a.Z)(W,2),K=G[0],Q=G[1],T=(0,v.useState)(""),$=(0,a.Z)(T,2),J=$[0],Y=$[1],X=(0,v.useState)(),nn=(0,a.Z)(X,2),en=nn[0],tn=nn[1],cn=(0,v.useState)([]),rn=(0,a.Z)(cn,2),on=rn[0],an=rn[1],sn=(0,v.useState)(),ln=(0,a.Z)(sn,2),un=ln[0],dn=ln[1],hn=(0,v.useState)(),pn=(0,a.Z)(hn,2),vn=pn[0],fn=pn[1],mn=function(n){"add"===n&&M(!R),"select"===n&&(E(!z),H([]))},xn=function(){var n=(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I.Z.post("/inventory-check/combine",{array:q});case 2:mn("select"),i((0,j.qL)());case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),_n=function(){Q(!1),fn(!1)},jn=function(){var n;an((function(n){return[].concat((0,o.Z)(n),[{article:un||B.article,count:en}])})),_n(),dn(),tn(),i((0,_.h)()),null===(n=w.current)||void 0===n||n.startScan()},gn=function(){for(var n=new Date,e=n.getDate()<10?"0"+n.getDate():n.getDate(),t=n.getMonth()<9?"0"+(n.getMonth()+1):n.getMonth()+1,c=n.getFullYear(),r="".concat(e,".").concat(t,".").concat(c),o=0,a=r,i=L.map((function(n){return n.name}));i.includes(a);)o+=1,a="".concat(r," (").concat(o,")");return a},bn=function(n){var e,t=0,r=(0,c.Z)(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;t+=Number(o.count)}}catch(a){r.e(a)}finally{r.f()}return t};return(0,v.useEffect)((function(){""!==J&&(B&&B.article&&Q(!0),null===B&&Q(!0))}),[B,J]),(0,v.useEffect)((function(){R||i((0,j.qL)())}),[R,i]),(0,S.jsxs)(S.Fragment,{children:[!R&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:l.modeButtons,children:[(0,S.jsx)("button",{className:l.addButton,onClick:function(){return mn("add")},children:(0,S.jsx)(d.Z,{fill:"transparent",fontSize:"large"})}),"owner"===A.role&&(0,S.jsx)("button",{className:"".concat(l.addButton," ").concat(l.selectButton," ").concat(z&&l.activeSelect),onClick:function(){return mn("select")},children:(0,S.jsx)(p.Z,{fill:"transparent",fontSize:"large"})})]}),(0,S.jsxs)("div",{children:[Z&&(0,S.jsx)("div",{className:l.listWrapper,children:(0,S.jsx)(u.Z,{color:"#c04545"})}),!Z&&L&&(0,S.jsxs)("div",{className:l.listWrapper,children:[(0,S.jsx)("ul",{className:l.list,children:L.map((function(n,e){return(0,S.jsx)("li",{className:"".concat(l.listItem," ").concat(q.includes(n._id)&&l.selectedItem),children:z?(0,S.jsxs)("div",{className:l.link,onClick:function(){return function(n){q.includes(L[n]._id)&&H((function(e){return(0,o.Z)(e.filter((function(e){return e!==L[n]._id})))})),q.includes(L[n]._id)||H((function(e){return[].concat((0,o.Z)(e),[L[n]._id])}))}(e)},children:[(0,S.jsx)("p",{children:n.name}),(0,S.jsxs)("p",{className:l.count,children:[bn(n.items),t("pcs"),"."]})]}):(0,S.jsxs)(C.rU,{className:l.link,to:"/inventory-check/".concat(n._id),children:[(0,S.jsx)("p",{children:n.name}),(0,S.jsxs)("p",{className:l.count,children:[bn(n.items),t("pcs"),"."]})]})},e)}))}),"owner"===A.role&&z&&(null===q||void 0===q?void 0:q.length)>1&&(0,S.jsx)("div",{children:(0,S.jsx)("button",{onClick:xn,className:"".concat(l.button," ").concat(l.combineButton),children:t("combine")})})]})]})]}),R&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("button",{className:"".concat(l.addButton," ").concat(l.closeButton),onClick:function(){return mn("add")},children:(0,S.jsx)(h.Z,{fill:"transparent",fontSize:"large"})}),(0,S.jsxs)("div",{className:l.controlArea,children:[(0,S.jsx)(f.m,{setLastResult:Y,ref:w}),(0,S.jsx)("button",{className:"".concat(l.addButton," ").concat(l.addArtBtn),onClick:function(){return fn(!0)},children:(0,S.jsx)(d.Z,{fill:"transparent",fontSize:"large"})})]}),B&&B.article&&(0,S.jsx)("button",{className:l.button,onClick:function(){return Q(!0)},children:t("last scan")}),(null===on||void 0===on?void 0:on.length)>0&&(0,S.jsxs)("div",{className:l.addListArea,children:[(0,S.jsx)("p",{children:gn()}),(0,S.jsx)("ul",{className:l.list,children:on.map((function(n,e){return(0,S.jsxs)("li",{className:l.listItem,children:[(0,S.jsxs)("p",{children:[t("article"),": ",n.article]}),(0,S.jsxs)("p",{className:l.count,children:[t("count"),": ",n.count,t("pcs"),"."]})]},e)}))}),(0,S.jsx)("button",{className:l.button,onClick:function(){var n={name:gn(),items:on};try{i((0,j.vE)(n)),M(!1),an([])}catch(e){k.ZP.error(e)}},children:t("save")})]}),(0,S.jsx)(y.N,{isOpen:K,close:_n,body:B&&B.article?(0,S.jsxs)("div",{className:l.modalArea,children:[Array.isArray(B.images)&&B.images.length>0?(0,S.jsx)("img",{className:l.modalImage,alt:"scanned product",src:B.images[0]}):(0,S.jsx)("p",{children:"No image"}),(0,S.jsx)("p",{children:"".concat((null===(n=B.name)||void 0===n?void 0:n.UA)||t("no name")," (").concat(B.article,")")}),(0,S.jsx)("p",{children:null!==(e=B.price)&&void 0!==e&&e.UAH?"".concat(B.price.UAH," \u0433\u0440\u043d."):"\u0426\u0435\u043d\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430"}),(0,S.jsxs)("div",{className:l.countArea,children:[(0,S.jsx)("input",{placeholder:t("count"),onChange:function(n){return tn(n.target.value)},defaultValue:en,className:l.countInput}),(0,S.jsx)("button",{className:l.countAddBtn,onClick:jn,children:t("add")})]})]}):null===B?(0,S.jsxs)("div",{children:[(0,S.jsxs)("p",{children:[t("product not found"),"!"]}),(0,S.jsxs)("p",{children:["barcode",": ",J]}),(0,S.jsxs)("div",{className:l.countArea,children:[(0,S.jsx)("input",{placeholder:t("article"),onChange:function(n){return dn(n.target.value)},defaultValue:un,className:l.countInput}),(0,S.jsx)("input",{placeholder:t("count"),onChange:function(n){return tn(n.target.value)},defaultValue:en,className:l.countInput}),(0,S.jsx)("button",{className:l.countAddBtn,onClick:jn,children:t("add")})]})]}):null}),(0,S.jsx)(y.N,{isOpen:vn,close:_n,body:(0,S.jsxs)("div",{className:"".concat(l.countArea," ").concat(l.notFoundArea),children:[(0,S.jsx)("input",{placeholder:t("article"),onChange:function(n){return dn(n.target.value)},className:l.countInput}),(0,S.jsx)("input",{placeholder:t("count"),onChange:function(n){return tn(n.target.value)},type:"number",className:l.countInput}),(0,S.jsx)("button",{className:l.countAddBtn,onClick:jn,children:t("add")})]})})]})]})},A=t(3050);function Z(){return(0,S.jsx)(A.B6,{children:(0,S.jsxs)("div",{children:[(0,S.jsx)(A.ql,{children:(0,S.jsx)("title",{children:"Inventory check"})}),(0,S.jsx)(B,{})]})})}},9567:function(n,e,t){t.d(e,{N:function(){return r},W:function(){return c}});var c=function(n){return n.inventory.items},r=function(n){return n.inventory.isLoading}},9654:function(n,e,t){t.d(e,{K:function(){return r},q:function(){return c}});var c=function(n){return n.products.items},r=function(n){return n.products.activeItem}},4270:function(n,e,t){t.d(e,{Z:function(){return l}});var c=t(2791),r={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function o(n){if("number"===typeof n)return{value:n,unit:"px"};var e,t=(n.match(/^[0-9.]*/)||"").toString();e=t.includes(".")?parseFloat(t):parseInt(t,10);var c=(n.match(/[^0-9]*$/)||"").toString();return r[c]?{value:e,unit:c}:(console.warn("React Spinners: ".concat(n," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}var a=function(){return a=Object.assign||function(n){for(var e,t=1,c=arguments.length;t<c;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},a.apply(this,arguments)},i=function(n,e){var t={};for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&e.indexOf(c)<0&&(t[c]=n[c]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(c=Object.getOwnPropertySymbols(n);r<c.length;r++)e.indexOf(c[r])<0&&Object.prototype.propertyIsEnumerable.call(n,c[r])&&(t[c[r]]=n[c[r]])}return t},s=function(n,e,t){var c="react-spinners-".concat(n,"-").concat(t);if("undefined"==typeof window||!window.document)return c;var r=document.createElement("style");document.head.appendChild(r);var o=r.sheet,a="\n    @keyframes ".concat(c," {\n      ").concat(e,"\n    }\n  ");return o&&o.insertRule(a,0),c}("ClockLoader","100% { transform: rotate(360deg) }","rotate");var l=function(n){var e=n.loading,t=void 0===e||e,r=n.color,l=void 0===r?"#000000":r,u=n.speedMultiplier,d=void 0===u?1:u,h=n.cssOverride,p=void 0===h?{}:h,v=n.size,f=void 0===v?50:v,m=i(n,["loading","color","speedMultiplier","cssOverride","size"]),x=o(f),_=x.value,j=x.unit,g=a({display:"inherit",position:"relative",width:"".concat(_).concat(j),height:"".concat(_).concat(j),backgroundColor:"transparent",boxShadow:"inset 0px 0px 0px 2px ".concat(l),borderRadius:"50%"},p),b={position:"absolute",backgroundColor:l,width:"".concat(_/3,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(8/d,"s linear infinite")},y={position:"absolute",backgroundColor:l,width:"".concat(_/2.4,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(2/d,"s linear infinite")};return t?c.createElement("span",a({style:g},m),c.createElement("span",{style:y}),c.createElement("span",{style:b})):null}},9536:function(n,e,t){var c=t(6811),r=t(184);e.Z=(0,c.Z)((0,r.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline")},478:function(n,e,t){var c=t(6811),r=t(184);e.Z=(0,c.Z)((0,r.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline")},6546:function(n,e,t){var c=t(6811),r=t(184);e.Z=(0,c.Z)((0,r.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"HighlightOff")}}]);
//# sourceMappingURL=222.db57c95c.chunk.js.map