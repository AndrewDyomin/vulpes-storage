"use strict";(self.webpackChunkvulpes_storage=self.webpackChunkvulpes_storage||[]).push([[279],{1448:function(e,t,n){n.d(t,{m:function(){return m}});var c=n(5861),r=n(9439),a=n(4687),i=n.n(a),o=n(2791),s={container:"BarcodeScanner_container__zdOxt",scanBlock:"BarcodeScanner_scanBlock__MR5A0",videoArea:"BarcodeScanner_videoArea__AA2r4",hide:"BarcodeScanner_hide__qqbBN",modalArea:"BarcodeScanner_modalArea__9PFQN",modalImage:"BarcodeScanner_modalImage__0uUA6",button:"BarcodeScanner_button__kNses"},l=n(1089),u=n(5612),d=n(4420),p=n(9654),v=n(9230),f=n(184),m=(0,o.forwardRef)((function(e,t){var n=e.setLastResult,a=(0,v.$G)().t,m=(0,d.I0)(),h=(0,d.v9)(p.K),x=(0,o.useRef)(null),_=(0,o.useRef)(null),j=(0,o.useState)([]),b=(0,r.Z)(j,2),g=b[0],y=b[1],k=(0,o.useState)(""),N=(0,r.Z)(k,2),w=N[0],Z=N[1],R=(0,o.useState)(null),C=(0,r.Z)(R,2),S=C[0],D=C[1],B=(0,o.useState)(!1),O=(0,r.Z)(B,2),A=O[0],I=O[1],F=(0,o.useRef)(new l.BrowserMultiFormatReader);(0,o.useEffect)((function(){var e=F.current;return navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return e.listVideoInputDevices()})).then((function(e){y(e),e.length>0&&Z(e[0].deviceId)})).catch((function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435:",e)})),function(){e.reset()}}),[]),(0,o.useImperativeHandle)(t,(function(){return{startScan:E,stopScan:M}}));var E=function(){I(!0),w&&F.current.decodeFromVideoDevice(w,x.current,function(){var e=(0,c.Z)(i().mark((function e(t,c){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t)try{"H"!==(null===t||void 0===t?void 0:t.text[0])&&(n(t.text),m((0,u.BD)(t.text)))}catch(c){console.error(c),D({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443"})}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},M=function(){I(!1),F.current.reset(),D(null)};return(0,o.useEffect)((function(){h&&h.article&&M(),null===h&&M()}),[h,S]),(0,f.jsxs)("div",{className:s.container,children:[(0,f.jsx)("div",{className:s.scanBlock,children:(0,f.jsx)("video",{ref:x,className:A?s.videoArea:s.hide})}),(0,f.jsxs)("div",{className:s.buttonsBlock,children:[(0,f.jsx)("button",{className:s.button,onClick:E,children:a("start")}),(0,f.jsx)("button",{className:s.button,onClick:M,children:a("reset")})]}),(0,f.jsxs)("div",{className:s.scanBlock,children:[(0,f.jsxs)("label",{htmlFor:"sourceSelect",children:[a("change video source"),":"]}),(0,f.jsx)("select",{ref:_,id:"sourceSelect",value:w,onChange:function(e){return Z(e.target.value)},children:g.map((function(e){return(0,f.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(e.deviceId)},e.deviceId)}))})]})]})}))},381:function(e,t,n){n.d(t,{N:function(){return l}});var c=n(3439),r=n(7948),a=n.n(r),i="PopUp_modalCloseButton__m06-1",o="PopUp_menuIcon__5-11v",s=n(184),l=function(e){var t=e.isOpen,n=e.close,r=e.body;return(0,s.jsxs)(a(),{isOpen:t,onRequestClose:n,style:{overlay:{backgroundColor:"rgba(9, 9, 9, 0.75)",position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",minWidth:"300px",maxWidth:"80%",width:"auto",maxHeight:"80%",padding:"50px 20px",borderRadius:"12px",border:"2px solid black",backgroundColor:"FFF",transition:"top 0.3s ease-in-out"}},ariaHideApp:!1,children:[(0,s.jsx)("button",{className:i,type:"button",onClick:n,children:(0,s.jsx)("svg",{className:o,children:(0,s.jsx)("use",{href:"".concat(c.Z,"#icon-close-circle")})})}),r]})}},5279:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var c=n(7762),r=n(3433),a=n(5861),i=n(9439),o=n(4687),s=n.n(o),l=n(4420),u=n(2791),d=n(8019),p=n(9654),v=n(4723),f=n(9136),m=n(4217),h=n(3275),x=n(9536),_=n(5294),j=n(5218),b=n(381),g=n(1448),y="ReceiveDetails_titleArea__1SkB6",k="ReceiveDetails_moreButton__TshTI",N="ReceiveDetails_list__qSSgZ",w="ReceiveDetails_item__lxMOp",Z="ReceiveDetails_itemImage__gbamk",R="ReceiveDetails_itemArticle__2Gn4J",C="ReceiveDetails_itemCount__WFjTo",S="ReceiveDetails_itemCountInput__Ll2qG",D="ReceiveDetails_moreModal__P4SjX",B="ReceiveDetails_modalButton__RFK+8",O="ReceiveDetails_delButton__TOwDF",A="ReceiveDetails_editButtons__nMH8d",I="ReceiveDetails_addButton__V-fvB",F="ReceiveDetails_saveBtnWrapper__36dmD",E="ReceiveDetails_saveButton__Y1zDC",M="ReceiveDetails_scanButton__WVyBD",P="ReceiveDetails_modalArea__oRTfd",U="ReceiveDetails_modalImage__MypDR",V="ReceiveDetails_countArea__70zcQ",z="ReceiveDetails_countInput__zSVhV",L="ReceiveDetails_countAddBtn__Df4Tk",H="ReceiveDetails_notFoundArea__D9KVn",q="ReceiveDetails_downloadButton__GF4Ms",T=n(9230),W=n(184),G=function(e){var t,n,o,G=e.id,K=(0,T.$G)().t,$=(0,l.I0)(),Q=(0,l.v9)(d.s),J=(0,l.v9)(p.K),X=(0,u.useRef)(),Y=Q.find((function(e){return e._id===G})),ee=(0,l.v9)(m.dy),te=(0,u.useState)([]),ne=(0,i.Z)(te,2),ce=ne[0],re=ne[1],ae=(0,u.useState)(!1),ie=(0,i.Z)(ae,2),oe=ie[0],se=ie[1],le=(0,u.useState)(!1),ue=(0,i.Z)(le,2),de=ue[0],pe=ue[1],ve=(0,u.useState)(!1),fe=(0,i.Z)(ve,2),me=fe[0],he=fe[1],xe=(0,u.useState)(!1),_e=(0,i.Z)(xe,2),je=_e[0],be=_e[1],ge=(0,u.useState)([]),ye=(0,i.Z)(ge,2),ke=ye[0],Ne=ye[1],we=(0,u.useState)(!1),Ze=(0,i.Z)(we,2),Re=Ze[0],Ce=Ze[1],Se=(0,u.useState)(""),De=(0,i.Z)(Se,2),Be=De[0],Oe=De[1],Ae=(0,u.useState)(),Ie=(0,i.Z)(Ae,2),Fe=Ie[0],Ee=Ie[1],Me=(0,u.useState)(),Pe=(0,i.Z)(Me,2),Ue=Pe[0],Ve=Pe[1],ze=function(){var e=(0,a.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.Z.post("/products/byarticle",{article:t});case 2:return n=e.sent,e.abrupt("return",n.data.product);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){se(!1),pe(!1),he(!1)},He=function(){var e=(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.Z.post("/receive-products/delete",{id:G});case 3:j.ZP.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0443\u0434\u0430\u043b\u0451\u043d"),Le(),window.history.back(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438:",e.t0.message),j.ZP.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),qe=function(){var e=(0,a.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:Y._id,items:[]},ke.forEach((function(e,n){var c=document.getElementById("".concat(n,"Count")),r=c?Number(c.value):0,a=""!==e.article?e.article:document.getElementById("".concat(n,"Article")).value;t.items.push({article:a,count:r})})),e.prev=2,e.next=5,_.Z.post("/receive-products/update",t);case 5:j.ZP.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0451\u043d"),window.history.back(),$((0,f.Lo)()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),j.ZP.error(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e;Ne((function(e){return[].concat((0,r.Z)(e),[{article:Ue||J.article,count:Fe}])})),he(!1),Ve(),Ee(),$((0,v.h)()),null===(e=X.current)||void 0===e||e.startScan()},We=function(){var e=(0,a.Z)(s().mark((function e(){var t,n,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.Z.post("/receive-products/download",{id:G},{responseType:"blob"});case 3:t=e.sent,n=window.URL.createObjectURL(new Blob([t.data])),(c=document.createElement("a")).href=n,c.setAttribute("download"),document.body.appendChild(c),c.click(),document.body.removeChild(c),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0438:",e.t0.message),j.ZP.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0438: ".concat(e.t0.message));case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){var e;if(Y&&null!==(e=Y.items)&&void 0!==e&&e.length){var t=function(){var e=(0,a.Z)(s().mark((function e(){var t,n,r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=(0,c.Z)(Y.items),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=18;break}return a=r.value,e.prev=6,e.next=9,ze(a.article);case 9:i=e.sent,t.push(i),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0430 ".concat(a.article,":"),e.t0.message);case 16:e.next=4;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(2),n.e(e.t1);case 23:return e.prev=23,n.f(),e.finish(23);case 26:re(t);case 27:case"end":return e.stop()}}),e,null,[[2,20,23,26],[6,13]])})));return function(){return e.apply(this,arguments)}}();t()}}),[Y]),(0,u.useEffect)((function(){""!==Be&&(J&&J.article&&he(!0),null===J&&he(!0))}),[J,Be]),(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:y,children:[(0,W.jsx)("h1",{children:null===Y||void 0===Y?void 0:Y.name}),(0,W.jsx)("button",{className:k,onClick:function(){return se(!0)},children:(0,W.jsx)(h.Z,{fontSize:"large"})})]}),Re&&(0,W.jsx)("div",{children:(0,W.jsx)(g.m,{setLastResult:Oe,ref:X})}),(0,W.jsxs)("p",{children:[K("items"),":"]}),(0,W.jsx)("ul",{className:N,children:null===(t=je?ke:Y.items)||void 0===t?void 0:t.map((function(e,t){var n,c=ce.find((function(t){return(null===t||void 0===t?void 0:t.article)===e.article}));return(0,W.jsxs)("li",{className:w,children:[(0,W.jsx)("img",{className:Z,alt:null===c||void 0===c||null===(n=c.name)||void 0===n?void 0:n.UA,src:null===c||void 0===c?void 0:c.images[0]}),je&&""===e.article?(0,W.jsx)("input",{id:"".concat(t,"Article"),placeholder:K("article"),className:R}):(0,W.jsxs)("p",{className:R,children:[K("article"),": ",e.article]}),je?(0,W.jsx)("input",{id:"".concat(t,"Count"),defaultValue:e.count,placeholder:K("count"),className:"".concat(C," ").concat(S)}):(0,W.jsxs)("p",{className:C,children:[e.count," ",K("pcs"),"."]})]},t)}))}),"owner"===ee.role&&(0,W.jsxs)("button",{className:q,onClick:We,children:[K("download")," .xlsx"]}),je&&(0,W.jsxs)("div",{className:A,children:[(0,W.jsx)("button",{className:I,onClick:function(){Ne((function(e){return[].concat((0,r.Z)(e),[{article:"",count:""}])}))},children:(0,W.jsx)(x.Z,{fill:"transparent",fontSize:"large"})}),(0,W.jsxs)("div",{className:F,children:[(0,W.jsx)("button",{className:E,onClick:qe,children:K("save")}),(0,W.jsx)("button",{className:"".concat(E," ").concat(M),onClick:function(){Ce(!0)},children:K("scan")})]})]}),(0,W.jsx)(b.N,{isOpen:oe,close:Le,body:(0,W.jsxs)("div",{className:D,children:[(0,W.jsx)("button",{className:B,onClick:function(){Ne((0,r.Z)(Y.items)),be(!0),Le()},children:K("edit")}),(0,W.jsx)("button",{className:"".concat(B," ").concat(O),onClick:function(){return pe(!0)},children:K("delete")})]})}),(0,W.jsx)(b.N,{isOpen:de,close:Le,body:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("p",{children:[K("are you sure"),"?"]}),(0,W.jsxs)("div",{className:D,children:[(0,W.jsx)("button",{className:B,onClick:Le,children:K("cancel")}),(0,W.jsx)("button",{className:"".concat(B," ").concat(O),onClick:He,children:K("delete")})]})]})}),(0,W.jsx)(b.N,{isOpen:me,close:Le,body:J&&J.article?(0,W.jsxs)("div",{className:P,children:[Array.isArray(J.images)&&J.images.length>0?(0,W.jsx)("img",{className:U,alt:"scanned product",src:J.images[0]}):(0,W.jsx)("p",{children:"No image"}),(0,W.jsx)("p",{children:"".concat((null===(n=J.name)||void 0===n?void 0:n.UA)||K("no name")," (").concat(J.article,")")}),(0,W.jsx)("p",{children:null!==(o=J.price)&&void 0!==o&&o.UAH?"".concat(J.price.UAH," \u0433\u0440\u043d."):"\u0426\u0435\u043d\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430"}),(0,W.jsxs)("div",{className:V,children:[(0,W.jsx)("input",{placeholder:K("count"),onChange:function(e){return Ee(e.target.value)},defaultValue:Fe,className:z,type:"number"}),(0,W.jsx)("button",{className:L,onClick:Te,children:K("add")})]})]}):null===J?(0,W.jsxs)("div",{children:[(0,W.jsx)("p",{children:K("product not found")}),(0,W.jsxs)("p",{children:[K("barcode"),": ",Be]}),(0,W.jsxs)("div",{className:"".concat(V," ").concat(H),children:[(0,W.jsx)("input",{placeholder:K("article"),onChange:function(e){return Ve(e.target.value)},defaultValue:Ue,className:z}),(0,W.jsx)("input",{placeholder:K("count"),onChange:function(e){return Ee(e.target.value)},defaultValue:Fe,className:z,type:"number"}),(0,W.jsx)("button",{className:L,onClick:Te,children:K("add")})]})]}):null})]})},K=n(3050),$=n(7689),Q=n(9567),J=n(4270);function X(){var e=(0,l.v9)(Q.N),t=(0,$.UO)().receiveId;return(0,W.jsx)(K.B6,{children:(0,W.jsxs)("div",{children:[(0,W.jsx)(K.ql,{children:(0,W.jsx)("title",{children:"List of products received"})}),e?(0,W.jsx)(J.Z,{color:"#c04545"}):(0,W.jsx)(G,{id:t})]})})}},9567:function(e,t,n){n.d(t,{N:function(){return r},W:function(){return c}});var c=function(e){return e.inventory.items},r=function(e){return e.inventory.isLoading}},9654:function(e,t,n){n.d(t,{K:function(){return r},q:function(){return c}});var c=function(e){return e.products.items},r=function(e){return e.products.activeItem}},8019:function(e,t,n){n.d(t,{N:function(){return r},s:function(){return c}});var c=function(e){return e.receive.items},r=function(e){return e.receive.isLoading}},4270:function(e,t,n){n.d(t,{Z:function(){return l}});var c=n(2791),r={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function a(e){if("number"===typeof e)return{value:e,unit:"px"};var t,n=(e.match(/^[0-9.]*/)||"").toString();t=n.includes(".")?parseFloat(n):parseInt(n,10);var c=(e.match(/[^0-9]*$/)||"").toString();return r[c]?{value:t,unit:c}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}var i=function(){return i=Object.assign||function(e){for(var t,n=1,c=arguments.length;n<c;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)},o=function(e,t){var n={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&t.indexOf(c)<0&&(n[c]=e[c]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(c=Object.getOwnPropertySymbols(e);r<c.length;r++)t.indexOf(c[r])<0&&Object.prototype.propertyIsEnumerable.call(e,c[r])&&(n[c[r]]=e[c[r]])}return n},s=function(e,t,n){var c="react-spinners-".concat(e,"-").concat(n);if("undefined"==typeof window||!window.document)return c;var r=document.createElement("style");document.head.appendChild(r);var a=r.sheet,i="\n    @keyframes ".concat(c," {\n      ").concat(t,"\n    }\n  ");return a&&a.insertRule(i,0),c}("ClockLoader","100% { transform: rotate(360deg) }","rotate");var l=function(e){var t=e.loading,n=void 0===t||t,r=e.color,l=void 0===r?"#000000":r,u=e.speedMultiplier,d=void 0===u?1:u,p=e.cssOverride,v=void 0===p?{}:p,f=e.size,m=void 0===f?50:f,h=o(e,["loading","color","speedMultiplier","cssOverride","size"]),x=a(m),_=x.value,j=x.unit,b=i({display:"inherit",position:"relative",width:"".concat(_).concat(j),height:"".concat(_).concat(j),backgroundColor:"transparent",boxShadow:"inset 0px 0px 0px 2px ".concat(l),borderRadius:"50%"},v),g={position:"absolute",backgroundColor:l,width:"".concat(_/3,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(8/d,"s linear infinite")},y={position:"absolute",backgroundColor:l,width:"".concat(_/2.4,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(2/d,"s linear infinite")};return n?c.createElement("span",i({style:b},h),c.createElement("span",{style:y}),c.createElement("span",{style:g})):null}},9536:function(e,t,n){var c=n(6811),r=n(184);t.Z=(0,c.Z)((0,r.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline")},3275:function(e,t,n){var c=n(6811),r=n(184);t.Z=(0,c.Z)((0,r.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz")}}]);
//# sourceMappingURL=279.b66c7f7f.chunk.js.map