"use strict";(self.webpackChunkvulpes_storage=self.webpackChunkvulpes_storage||[]).push([[525],{1448:function(e,n,t){t.d(n,{m:function(){return f}});var r=t(5861),c=t(9439),a=t(4687),o=t.n(a),s=t(2791),i={container:"BarcodeScanner_container__zdOxt",scanBlock:"BarcodeScanner_scanBlock__MR5A0",videoArea:"BarcodeScanner_videoArea__AA2r4",hide:"BarcodeScanner_hide__qqbBN",modalArea:"BarcodeScanner_modalArea__9PFQN",modalImage:"BarcodeScanner_modalImage__0uUA6",button:"BarcodeScanner_button__kNses"},l=t(1089),u=t(5612),d=t(4420),v=t(9654),p=t(9230),h=t(184),f=(0,s.forwardRef)((function(e,n){var t=e.setLastResult,a=(0,p.$G)().t,f=(0,d.I0)(),m=(0,d.v9)(v.K),x=(0,s.useRef)(null),_=(0,s.useRef)(null),y=(0,s.useState)([]),j=(0,c.Z)(y,2),b=j[0],k=j[1],g=(0,s.useState)(""),C=(0,c.Z)(g,2),N=C[0],I=C[1],w=(0,s.useState)(null),Z=(0,c.Z)(w,2),S=Z[0],B=Z[1],D=(0,s.useState)(!1),A=(0,c.Z)(D,2),O=A[0],R=A[1],P=(0,s.useRef)(new l.BrowserMultiFormatReader);(0,s.useEffect)((function(){var e=P.current;return navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return e.listVideoInputDevices()})).then((function(e){k(e),e.length>0&&I(e[0].deviceId)})).catch((function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435:",e)})),function(){e.reset()}}),[]),(0,s.useImperativeHandle)(n,(function(){return{startScan:U,stopScan:E}}));var U=function(){R(!0),N&&P.current.decodeFromVideoDevice(N,x.current,function(){var e=(0,r.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n)try{"H"!==(null===n||void 0===n?void 0:n.text[0])&&(t(n.text),f((0,u.BD)(n.text)))}catch(r){console.error(r),B({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443"})}case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}())},E=function(){R(!1),P.current.reset(),B(null)};return(0,s.useEffect)((function(){m&&m.article&&E(),null===m&&E()}),[m,S]),(0,h.jsxs)("div",{className:i.container,children:[(0,h.jsx)("div",{className:i.scanBlock,children:(0,h.jsx)("video",{ref:x,className:O?i.videoArea:i.hide})}),(0,h.jsxs)("div",{className:i.buttonsBlock,children:[(0,h.jsx)("button",{className:i.button,onClick:U,children:a("start")}),(0,h.jsx)("button",{className:i.button,onClick:E,children:a("reset")})]}),(0,h.jsxs)("div",{className:i.scanBlock,children:[(0,h.jsxs)("label",{htmlFor:"sourceSelect",children:[a("change video source"),":"]}),(0,h.jsx)("select",{ref:_,id:"sourceSelect",value:N,onChange:function(e){return I(e.target.value)},children:b.map((function(e){return(0,h.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(e.deviceId)},e.deviceId)}))})]})]})}))},381:function(e,n,t){t.d(n,{N:function(){return l}});var r=t(3439),c=t(7948),a=t.n(c),o="PopUp_modalCloseButton__m06-1",s="PopUp_menuIcon__5-11v",i=t(184),l=function(e){var n=e.isOpen,t=e.close,c=e.body;return(0,i.jsxs)(a(),{isOpen:n,onRequestClose:t,style:{overlay:{backgroundColor:"rgba(9, 9, 9, 0.75)",position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",minWidth:"300px",maxWidth:"80%",width:"auto",maxHeight:"80%",padding:"50px 20px",borderRadius:"12px",border:"2px solid black",backgroundColor:"FFF",transition:"top 0.3s ease-in-out"}},ariaHideApp:!1,children:[(0,i.jsx)("button",{className:o,type:"button",onClick:t,children:(0,i.jsx)("svg",{className:s,children:(0,i.jsx)("use",{href:"".concat(r.Z,"#icon-close-circle")})})}),c]})}},1525:function(e,n,t){t.r(n),t.d(n,{default:function(){return $}});var r=t(7762),c=t(3433),a=t(5861),o=t(9439),s=t(4687),i=t.n(s),l=t(4420),u=t(2791),d=t(9567),v=t(9654),p=t(4723),h=t(4217),f=t(3275),m=t(9536),x=t(5294),_=t(5218),y=t(381),j=t(1448),b="InventoryCheckDetails_titleArea__I-a9B",k="InventoryCheckDetails_moreButton__V3hyh",g="InventoryCheckDetails_list__JobJk",C="InventoryCheckDetails_item__XUJON",N="InventoryCheckDetails_itemImage__CLNXX",I="InventoryCheckDetails_itemArticle__VHXCd",w="InventoryCheckDetails_itemCount__SNtz3",Z="InventoryCheckDetails_itemCountInput__DURP1",S="InventoryCheckDetails_moreModal__kGGDn",B="InventoryCheckDetails_modalButton__tt1J8",D="InventoryCheckDetails_delButton__oPsgy",A="InventoryCheckDetails_editButtons__75Qai",O="InventoryCheckDetails_addButton__wRCZC",R="InventoryCheckDetails_saveBtnWrapper__lZM3-",P="InventoryCheckDetails_saveButton__aYaVG",U="InventoryCheckDetails_scanButton__HCnIa",E="InventoryCheckDetails_modalArea__-4JMX",F="InventoryCheckDetails_modalImage__dUBSg",H="InventoryCheckDetails_countArea__Clfwh",M="InventoryCheckDetails_countInput__HCLuM",L="InventoryCheckDetails_countAddBtn__m1Hms",V="InventoryCheckDetails_notFoundArea__qYXDF",z="InventoryCheckDetails_downloadButton__cLKNu",q=t(9230),X=t(184),G=function(e){var n,t,s,G=e.id,J=(0,q.$G)().t,W=(0,l.I0)(),K=(0,l.v9)(d.W),$=(0,l.v9)(v.K),Q=(0,u.useRef)(),Y=K.find((function(e){return e._id===G})),T=(0,l.v9)(h.dy),ee=(0,u.useState)([]),ne=(0,o.Z)(ee,2),te=ne[0],re=ne[1],ce=(0,u.useState)(!1),ae=(0,o.Z)(ce,2),oe=ae[0],se=ae[1],ie=(0,u.useState)(!1),le=(0,o.Z)(ie,2),ue=le[0],de=le[1],ve=(0,u.useState)(!1),pe=(0,o.Z)(ve,2),he=pe[0],fe=pe[1],me=(0,u.useState)(!1),xe=(0,o.Z)(me,2),_e=xe[0],ye=xe[1],je=(0,u.useState)([]),be=(0,o.Z)(je,2),ke=be[0],ge=be[1],Ce=(0,u.useState)(!1),Ne=(0,o.Z)(Ce,2),Ie=Ne[0],we=Ne[1],Ze=(0,u.useState)(""),Se=(0,o.Z)(Ze,2),Be=Se[0],De=Se[1],Ae=(0,u.useState)(),Oe=(0,o.Z)(Ae,2),Re=Oe[0],Pe=Oe[1],Ue=(0,u.useState)(),Ee=(0,o.Z)(Ue,2),Fe=Ee[0],He=Ee[1],Me=function(){var e=(0,a.Z)(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.Z.post("/products/byarticle",{article:n});case 2:return t=e.sent,e.abrupt("return",t.data.product);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Le=function(){se(!1),de(!1),fe(!1)},Ve=function(){var e=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Z.post("/inventory-check/delete",{id:G});case 3:_.ZP.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0443\u0434\u0430\u043b\u0451\u043d"),Le(),window.history.back(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438:",e.t0.message),_.ZP.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=(0,a.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:Y._id,items:[]},ke.forEach((function(e,t){var r=document.getElementById("".concat(t,"Count")),c=r?Number(r.value):0,a=""!==e.article?e.article:document.getElementById("".concat(t,"Article")).value;n.items.push({article:a,count:c})})),e.prev=2,e.next=5,x.Z.post("/inventory-check/update",n);case 5:_.ZP.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0451\u043d"),window.history.back(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),_.ZP.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),qe=function(){var e;ge((function(e){return[].concat((0,c.Z)(e),[{article:Fe||$.article,count:Re}])})),fe(!1),He(),Pe(),W((0,p.h)()),null===(e=Q.current)||void 0===e||e.startScan()},Xe=function(){var e=(0,a.Z)(i().mark((function e(){var n,t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.Z.post("/inventory-check/download",{id:G},{responseType:"blob"});case 3:n=e.sent,t=window.URL.createObjectURL(new Blob([n.data])),(r=document.createElement("a")).href=t,r.setAttribute("download"),document.body.appendChild(r),r.click(),document.body.removeChild(r),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0438:",e.t0.message),_.ZP.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0438: ".concat(e.t0.message));case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){var e;if(Y&&null!==(e=Y.items)&&void 0!==e&&e.length){var n=function(){var e=(0,a.Z)(i().mark((function e(){var n,t,c,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t=(0,r.Z)(Y.items),e.prev=2,t.s();case 4:if((c=t.n()).done){e.next=18;break}return a=c.value,e.prev=6,e.next=9,Me(a.article);case 9:o=e.sent,n.push(o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0430 ".concat(a.article,":"),e.t0.message);case 16:e.next=4;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(2),t.e(e.t1);case 23:return e.prev=23,t.f(),e.finish(23);case 26:re(n);case 27:case"end":return e.stop()}}),e,null,[[2,20,23,26],[6,13]])})));return function(){return e.apply(this,arguments)}}();n()}}),[Y]),(0,u.useEffect)((function(){""!==Be&&($&&$.article&&fe(!0),null===$&&fe(!0))}),[$,Be]),(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)("div",{className:b,children:[(0,X.jsx)("h1",{children:null===Y||void 0===Y?void 0:Y.name}),(0,X.jsx)("button",{className:k,onClick:function(){return se(!0)},children:(0,X.jsx)(f.Z,{fontSize:"large"})})]}),Ie&&(0,X.jsx)("div",{children:(0,X.jsx)(j.m,{setLastResult:De,ref:Q})}),(0,X.jsxs)("p",{children:[J("items"),":"]}),(0,X.jsx)("ul",{className:g,children:null===(n=_e?ke:Y.items)||void 0===n?void 0:n.map((function(e,n){var t,r=te.find((function(n){return(null===n||void 0===n?void 0:n.article)===e.article}));return(0,X.jsxs)("li",{className:C,children:[(0,X.jsx)("img",{className:N,alt:null===r||void 0===r||null===(t=r.name)||void 0===t?void 0:t.UA,src:null===r||void 0===r?void 0:r.images[0]}),_e&&""===e.article?(0,X.jsx)("input",{id:"".concat(n,"Article"),placeholder:J("article"),className:I}):(0,X.jsxs)("p",{className:I,children:[J("article"),": ",e.article]}),_e?(0,X.jsx)("input",{id:"".concat(n,"Count"),defaultValue:e.count,placeholder:J("count"),className:"".concat(w," ").concat(Z)}):(0,X.jsxs)("p",{className:w,children:[e.count," ",J("pcs"),"."]})]},n)}))}),"owner"===T.role&&(0,X.jsxs)("button",{className:z,onClick:Xe,children:[J("download")," .xlsx"]}),_e&&(0,X.jsxs)("div",{className:A,children:[(0,X.jsx)("button",{className:O,onClick:function(){ge((function(e){return[].concat((0,c.Z)(e),[{article:"",count:""}])}))},children:(0,X.jsx)(m.Z,{fill:"transparent",fontSize:"large"})}),(0,X.jsxs)("div",{className:R,children:[(0,X.jsx)("button",{className:P,onClick:ze,children:J("save")}),(0,X.jsx)("button",{className:"".concat(P," ").concat(U),onClick:function(){we(!0)},children:J("scan")})]})]}),(0,X.jsx)(y.N,{isOpen:oe,close:Le,body:(0,X.jsxs)("div",{className:S,children:[(0,X.jsx)("button",{className:B,onClick:function(){ge((0,c.Z)(Y.items)),ye(!0),Le()},children:J("edit")}),(0,X.jsx)("button",{className:"".concat(B," ").concat(D),onClick:function(){return de(!0)},children:J("delete")})]})}),(0,X.jsx)(y.N,{isOpen:ue,close:Le,body:(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)("p",{children:[J("are you sure"),"?"]}),(0,X.jsxs)("div",{className:S,children:[(0,X.jsx)("button",{className:B,onClick:Le,children:J("cancel")}),(0,X.jsx)("button",{className:"".concat(B," ").concat(D),onClick:Ve,children:J("delete")})]})]})}),(0,X.jsx)(y.N,{isOpen:he,close:Le,body:$&&$.article?(0,X.jsxs)("div",{className:E,children:[Array.isArray($.images)&&$.images.length>0?(0,X.jsx)("img",{className:F,alt:"scanned product",src:$.images[0]}):(0,X.jsx)("p",{children:"No image"}),(0,X.jsx)("p",{children:"".concat((null===(t=$.name)||void 0===t?void 0:t.UA)||J("no name")," (").concat($.article,")")}),(0,X.jsx)("p",{children:null!==(s=$.price)&&void 0!==s&&s.UAH?"".concat($.price.UAH," \u0433\u0440\u043d."):"\u0426\u0435\u043d\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430"}),(0,X.jsxs)("div",{className:H,children:[(0,X.jsx)("input",{placeholder:J("count"),onChange:function(e){return Pe(e.target.value)},defaultValue:Re,className:M,type:"number"}),(0,X.jsx)("button",{className:L,onClick:qe,children:J("add")})]})]}):null===$?(0,X.jsxs)("div",{children:[(0,X.jsx)("p",{children:J("product not found")}),(0,X.jsxs)("p",{children:[J("barcode"),": ",Be]}),(0,X.jsxs)("div",{className:"".concat(H," ").concat(V),children:[(0,X.jsx)("input",{placeholder:J("article"),onChange:function(e){return He(e.target.value)},defaultValue:Fe,className:M}),(0,X.jsx)("input",{placeholder:J("count"),onChange:function(e){return Pe(e.target.value)},defaultValue:Re,className:M,type:"number"}),(0,X.jsx)("button",{className:L,onClick:qe,children:J("add")})]})]}):null})]})},J=t(3050),W=t(7689),K=t(4270);function $(){var e=(0,l.v9)(d.N),n=(0,W.UO)().inventoryId;return(0,X.jsx)(J.B6,{children:(0,X.jsxs)("div",{children:[(0,X.jsx)(J.ql,{children:(0,X.jsx)("title",{children:"Inventory check details"})}),e?(0,X.jsx)(K.Z,{color:"#c04545"}):(0,X.jsx)(G,{id:n})]})})}},9567:function(e,n,t){t.d(n,{N:function(){return c},W:function(){return r}});var r=function(e){return e.inventory.items},c=function(e){return e.inventory.isLoading}},9654:function(e,n,t){t.d(n,{K:function(){return c},q:function(){return r}});var r=function(e){return e.products.items},c=function(e){return e.products.activeItem}},4270:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(2791),c={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function a(e){if("number"===typeof e)return{value:e,unit:"px"};var n,t=(e.match(/^[0-9.]*/)||"").toString();n=t.includes(".")?parseFloat(t):parseInt(t,10);var r=(e.match(/[^0-9]*$/)||"").toString();return c[r]?{value:n,unit:r}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(n,"px.")),{value:n,unit:"px"})}var o=function(){return o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var c in n=arguments[t])Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c]);return e},o.apply(this,arguments)},s=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(r=Object.getOwnPropertySymbols(e);c<r.length;c++)n.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(e,r[c])&&(t[r[c]]=e[r[c]])}return t},i=function(e,n,t){var r="react-spinners-".concat(e,"-").concat(t);if("undefined"==typeof window||!window.document)return r;var c=document.createElement("style");document.head.appendChild(c);var a=c.sheet,o="\n    @keyframes ".concat(r," {\n      ").concat(n,"\n    }\n  ");return a&&a.insertRule(o,0),r}("ClockLoader","100% { transform: rotate(360deg) }","rotate");var l=function(e){var n=e.loading,t=void 0===n||n,c=e.color,l=void 0===c?"#000000":c,u=e.speedMultiplier,d=void 0===u?1:u,v=e.cssOverride,p=void 0===v?{}:v,h=e.size,f=void 0===h?50:h,m=s(e,["loading","color","speedMultiplier","cssOverride","size"]),x=a(f),_=x.value,y=x.unit,j=o({display:"inherit",position:"relative",width:"".concat(_).concat(y),height:"".concat(_).concat(y),backgroundColor:"transparent",boxShadow:"inset 0px 0px 0px 2px ".concat(l),borderRadius:"50%"},p),b={position:"absolute",backgroundColor:l,width:"".concat(_/3,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(i," ").concat(8/d,"s linear infinite")},k={position:"absolute",backgroundColor:l,width:"".concat(_/2.4,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(i," ").concat(2/d,"s linear infinite")};return t?r.createElement("span",o({style:j},m),r.createElement("span",{style:k}),r.createElement("span",{style:b})):null}},9536:function(e,n,t){var r=t(6811),c=t(184);n.Z=(0,r.Z)((0,c.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline")},3275:function(e,n,t){var r=t(6811),c=t(184);n.Z=(0,r.Z)((0,c.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz")}}]);
//# sourceMappingURL=525.37738f5b.chunk.js.map