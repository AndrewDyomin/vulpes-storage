"use strict";(self.webpackChunkvulpes_storage=self.webpackChunkvulpes_storage||[]).push([[703],{1448:function(e,n,t){t.d(n,{m:function(){return f}});var c=t(5861),r=t(9439),o=t(4687),a=t.n(o),i=t(2791),s={container:"BarcodeScanner_container__zdOxt",scanBlock:"BarcodeScanner_scanBlock__MR5A0",videoArea:"BarcodeScanner_videoArea__AA2r4",hide:"BarcodeScanner_hide__qqbBN",modalArea:"BarcodeScanner_modalArea__9PFQN",modalImage:"BarcodeScanner_modalImage__0uUA6",button:"BarcodeScanner_button__kNses"},l=t(1089),u=t(5612),d=t(4420),h=t(9654),p=t(9230),v=t(184),f=(0,i.forwardRef)((function(e,n){var t=e.setLastResult,o=(0,p.$G)().t,f=(0,d.I0)(),m=(0,d.v9)(h.K),x=(0,i.useRef)(null),_=(0,i.useRef)(null),j=(0,i.useState)([]),g=(0,r.Z)(j,2),b=g[0],y=g[1],k=(0,i.useState)(""),C=(0,r.Z)(k,2),N=C[0],I=C[1],S=(0,i.useState)(null),B=(0,r.Z)(S,2),A=B[0],Z=B[1],L=(0,i.useState)(!1),w=(0,r.Z)(L,2),O=w[0],F=w[1],R=(0,i.useRef)(new l.BrowserMultiFormatReader);(0,i.useEffect)((function(){var e=R.current;return navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return e.listVideoInputDevices()})).then((function(e){y(e),e.length>0&&I(e[0].deviceId)})).catch((function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435:",e)})),function(){e.reset()}}),[]),(0,i.useImperativeHandle)(n,(function(){return{startScan:M,stopScan:U}}));var M=function(){F(!0),N&&R.current.decodeFromVideoDevice(N,x.current,function(){var e=(0,c.Z)(a().mark((function e(n,c){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n)try{"H"!==(null===n||void 0===n?void 0:n.text[0])&&(t(n.text),f((0,u.BD)(n.text)))}catch(c){console.error(c),Z({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443"})}case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}())},U=function(){F(!1),R.current.reset(),Z(null)};return(0,i.useEffect)((function(){m&&m.article&&U(),null===m&&U()}),[m,A]),(0,v.jsxs)("div",{className:s.container,children:[(0,v.jsx)("div",{className:s.scanBlock,children:(0,v.jsx)("video",{ref:x,className:O?s.videoArea:s.hide})}),(0,v.jsxs)("div",{className:s.buttonsBlock,children:[(0,v.jsx)("button",{className:s.button,onClick:M,children:o("start")}),(0,v.jsx)("button",{className:s.button,onClick:U,children:o("reset")})]}),(0,v.jsxs)("div",{className:s.scanBlock,children:[(0,v.jsxs)("label",{htmlFor:"sourceSelect",children:[o("change video source"),":"]}),(0,v.jsx)("select",{ref:_,id:"sourceSelect",value:N,onChange:function(e){return I(e.target.value)},children:b.map((function(e){return(0,v.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(e.deviceId)},e.deviceId)}))})]})]})}))},381:function(e,n,t){t.d(n,{N:function(){return l}});var c=t(3439),r=t(7948),o=t.n(r),a="PopUp_modalCloseButton__m06-1",i="PopUp_menuIcon__5-11v",s=t(184),l=function(e){var n=e.isOpen,t=e.close,r=e.body;return(0,s.jsxs)(o(),{isOpen:n,onRequestClose:t,style:{overlay:{backgroundColor:"rgba(9, 9, 9, 0.75)",position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",minWidth:"300px",maxWidth:"80%",width:"auto",maxHeight:"80%",padding:"50px 20px",borderRadius:"12px",border:"2px solid black",backgroundColor:"FFF",transition:"top 0.3s ease-in-out"}},ariaHideApp:!1,children:[(0,s.jsx)("button",{className:a,type:"button",onClick:t,children:(0,s.jsx)("svg",{className:i,children:(0,s.jsx)("use",{href:"".concat(c.Z,"#icon-close-circle")})})}),r]})}},6703:function(e,n,t){t.r(n),t.d(n,{default:function(){return L}});var c=t(7762),r=t(5861),o=t(3433),a=t(9439),i=t(4687),s=t.n(i),l={listWrapper:"InventoryCheckList_listWrapper__ZmVhv",controlArea:"InventoryCheckList_controlArea__qzRVJ",modeButtons:"InventoryCheckList_modeButtons__S5Uyv",addButton:"InventoryCheckList_addButton__GF6NK",selectButton:"InventoryCheckList_selectButton__TSjrs",activeSelect:"InventoryCheckList_activeSelect__NlVrU",addArtBtn:"InventoryCheckList_addArtBtn__jDfjx",modalArea:"InventoryCheckList_modalArea__P1CSU",modalImage:"InventoryCheckList_modalImage__eAl2A",button:"InventoryCheckList_button__apVqB",countArea:"InventoryCheckList_countArea__B0ih7",countInput:"InventoryCheckList_countInput__dfopf",countAddBtn:"InventoryCheckList_countAddBtn__TlZrB",addListArea:"InventoryCheckList_addListArea__p0QVr",list:"InventoryCheckList_list__J6D9u",listItem:"InventoryCheckList_listItem__UnQTL",selectedItem:"InventoryCheckList_selectedItem__D27GP",link:"InventoryCheckList_link__MUYxS",count:"InventoryCheckList_count__So13G",notFoundArea:"InventoryCheckList_notFoundArea__XNR+b",combineButton:"InventoryCheckList_combineButton__kZMfo"},u=t(4270),d=t(9536),h=t(6811),p=t(184),v=(0,h.Z)((0,p.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"HighlightOff"),f=(0,h.Z)((0,p.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline"),m=t(2791),x=t(1448),_=t(9654),j=t(9567),g=t(4723),b=t(3600),y=t(4217),k=t(4420),C=t(381),N=t(5218),I=t(1087),S=t(9230),B=t(5294),A=function(){var e,n,t=(0,S.$G)().t,i=(0,k.I0)(),h=(0,k.v9)(_.K),A=(0,k.v9)(y.dy),Z=(0,k.v9)(j.N),L=(0,k.v9)(j.W),w=(0,m.useRef)(),O=(0,m.useState)(!1),F=(0,a.Z)(O,2),R=F[0],M=F[1],U=(0,m.useState)(!1),D=(0,a.Z)(U,2),z=D[0],E=D[1],P=(0,m.useState)([]),V=(0,a.Z)(P,2),q=V[0],H=V[1],W=(0,m.useState)(!1),G=(0,a.Z)(W,2),K=G[0],Q=G[1],T=(0,m.useState)(""),$=(0,a.Z)(T,2),J=$[0],Y=$[1],X=(0,m.useState)(),ee=(0,a.Z)(X,2),ne=ee[0],te=ee[1],ce=(0,m.useState)([]),re=(0,a.Z)(ce,2),oe=re[0],ae=re[1],ie=(0,m.useState)(),se=(0,a.Z)(ie,2),le=se[0],ue=se[1],de=(0,m.useState)(),he=(0,a.Z)(de,2),pe=he[0],ve=he[1],fe=function(e){"add"===e&&M(!R),"select"===e&&(E(!z),H([]))},me=function(){var e=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.Z.post("/inventory-check/combine",{array:q});case 2:fe("select"),i((0,b.qL)());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){Q(!1),ve(!1)},_e=function(){var e;ae((function(e){return[].concat((0,o.Z)(e),[{article:le||h.article,count:ne}])})),xe(),ue(),te(),i((0,g.h)()),null===(e=w.current)||void 0===e||e.startScan()},je=function(){for(var e=new Date,n=e.getDate()<10?"0"+e.getDate():e.getDate(),t=e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,c=e.getFullYear(),r="".concat(n,".").concat(t,".").concat(c),o=0,a=r,i=L.map((function(e){return e.name}));i.includes(a);)o+=1,a="".concat(r," (").concat(o,")");return a},ge=function(e){var n,t=0,r=(0,c.Z)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;t+=Number(o.count)}}catch(a){r.e(a)}finally{r.f()}return t};return(0,m.useEffect)((function(){""!==J&&(h&&h.article&&Q(!0),null===h&&Q(!0))}),[h,J]),(0,m.useEffect)((function(){R||i((0,b.qL)())}),[R,i]),(0,p.jsxs)(p.Fragment,{children:[!R&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:l.modeButtons,children:[(0,p.jsx)("button",{className:l.addButton,onClick:function(){return fe("add")},children:(0,p.jsx)(d.Z,{fill:"transparent",fontSize:"large"})}),"owner"===A.role&&(0,p.jsx)("button",{className:"".concat(l.addButton," ").concat(l.selectButton," ").concat(z&&l.activeSelect),onClick:function(){return fe("select")},children:(0,p.jsx)(f,{fill:"transparent",fontSize:"large"})})]}),(0,p.jsxs)("div",{children:[Z&&(0,p.jsx)("div",{className:l.listWrapper,children:(0,p.jsx)(u.Z,{color:"#c04545"})}),!Z&&L&&(0,p.jsxs)("div",{className:l.listWrapper,children:[(0,p.jsx)("ul",{className:l.list,children:L.map((function(e,n){return(0,p.jsx)("li",{className:"".concat(l.listItem," ").concat(q.includes(e._id)&&l.selectedItem),children:z?(0,p.jsxs)("div",{className:l.link,onClick:function(){return function(e){q.includes(L[e]._id)&&H((function(n){return(0,o.Z)(n.filter((function(n){return n!==L[e]._id})))})),q.includes(L[e]._id)||H((function(n){return[].concat((0,o.Z)(n),[L[e]._id])}))}(n)},children:[(0,p.jsx)("p",{children:e.name}),(0,p.jsxs)("p",{className:l.count,children:[ge(e.items),t("pcs"),"."]})]}):(0,p.jsxs)(I.rU,{className:l.link,to:"/inventory-check/".concat(e._id),children:[(0,p.jsx)("p",{children:e.name}),(0,p.jsxs)("p",{className:l.count,children:[ge(e.items),t("pcs"),"."]})]})},n)}))}),"owner"===A.role&&z&&(null===q||void 0===q?void 0:q.length)>1&&(0,p.jsx)("div",{children:(0,p.jsx)("button",{onClick:me,className:"".concat(l.button," ").concat(l.combineButton),children:t("combine")})})]})]})]}),R&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("button",{className:"".concat(l.addButton," ").concat(l.closeButton),onClick:function(){return fe("add")},children:(0,p.jsx)(v,{fill:"transparent",fontSize:"large"})}),(0,p.jsxs)("div",{className:l.controlArea,children:[(0,p.jsx)(x.m,{setLastResult:Y,ref:w}),(0,p.jsx)("button",{className:"".concat(l.addButton," ").concat(l.addArtBtn),onClick:function(){return ve(!0)},children:(0,p.jsx)(d.Z,{fill:"transparent",fontSize:"large"})})]}),h&&h.article&&(0,p.jsx)("button",{className:l.button,onClick:function(){return Q(!0)},children:t("last scan")}),(null===oe||void 0===oe?void 0:oe.length)>0&&(0,p.jsxs)("div",{className:l.addListArea,children:[(0,p.jsx)("p",{children:je()}),(0,p.jsx)("ul",{className:l.list,children:oe.map((function(e,n){return(0,p.jsxs)("li",{className:l.listItem,children:[(0,p.jsxs)("p",{children:[t("article"),": ",e.article]}),(0,p.jsxs)("p",{className:l.count,children:[t("count"),": ",e.count,t("pcs"),"."]})]},n)}))}),(0,p.jsx)("button",{className:l.button,onClick:function(){var e={name:je(),items:oe};try{i((0,b.vE)(e)),M(!1),ae([])}catch(n){N.ZP.error(n)}},children:t("save")})]}),(0,p.jsx)(C.N,{isOpen:K,close:xe,body:h&&h.article?(0,p.jsxs)("div",{className:l.modalArea,children:[Array.isArray(h.images)&&h.images.length>0?(0,p.jsx)("img",{className:l.modalImage,alt:"scanned product",src:h.images[0]}):(0,p.jsx)("p",{children:"No image"}),(0,p.jsx)("p",{children:"".concat((null===(e=h.name)||void 0===e?void 0:e.UA)||t("no name")," (").concat(h.article,")")}),(0,p.jsx)("p",{children:null!==(n=h.price)&&void 0!==n&&n.UAH?"".concat(h.price.UAH," \u0433\u0440\u043d."):"\u0426\u0435\u043d\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430"}),(0,p.jsxs)("div",{className:l.countArea,children:[(0,p.jsx)("input",{placeholder:t("count"),onChange:function(e){return te(e.target.value)},defaultValue:ne,className:l.countInput}),(0,p.jsx)("button",{className:l.countAddBtn,onClick:_e,children:t("add")})]})]}):null===h?(0,p.jsxs)("div",{children:[(0,p.jsxs)("p",{children:[t("product not found"),"!"]}),(0,p.jsxs)("p",{children:["barcode",": ",J]}),(0,p.jsxs)("div",{className:l.countArea,children:[(0,p.jsx)("input",{placeholder:t("article"),onChange:function(e){return ue(e.target.value)},defaultValue:le,className:l.countInput}),(0,p.jsx)("input",{placeholder:t("count"),onChange:function(e){return te(e.target.value)},defaultValue:ne,className:l.countInput}),(0,p.jsx)("button",{className:l.countAddBtn,onClick:_e,children:t("add")})]})]}):null}),(0,p.jsx)(C.N,{isOpen:pe,close:xe,body:(0,p.jsxs)("div",{className:"".concat(l.countArea," ").concat(l.notFoundArea),children:[(0,p.jsx)("input",{placeholder:t("article"),onChange:function(e){return ue(e.target.value)},className:l.countInput}),(0,p.jsx)("input",{placeholder:t("count"),onChange:function(e){return te(e.target.value)},type:"number",className:l.countInput}),(0,p.jsx)("button",{className:l.countAddBtn,onClick:_e,children:t("add")})]})})]})]})},Z=t(3050);function L(){return(0,p.jsx)(Z.B6,{children:(0,p.jsxs)("div",{children:[(0,p.jsx)(Z.ql,{children:(0,p.jsx)("title",{children:"Inventory check"})}),(0,p.jsx)(A,{})]})})}},9567:function(e,n,t){t.d(n,{N:function(){return r},W:function(){return c}});var c=function(e){return e.inventory.items},r=function(e){return e.inventory.isLoading}},9654:function(e,n,t){t.d(n,{K:function(){return r},q:function(){return c}});var c=function(e){return e.products.items},r=function(e){return e.products.activeItem}},4270:function(e,n,t){t.d(n,{Z:function(){return l}});var c=t(2791),r={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function o(e){if("number"===typeof e)return{value:e,unit:"px"};var n,t=(e.match(/^[0-9.]*/)||"").toString();n=t.includes(".")?parseFloat(t):parseInt(t,10);var c=(e.match(/[^0-9]*$/)||"").toString();return r[c]?{value:n,unit:c}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(n,"px.")),{value:n,unit:"px"})}var a=function(){return a=Object.assign||function(e){for(var n,t=1,c=arguments.length;t<c;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},a.apply(this,arguments)},i=function(e,n){var t={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&n.indexOf(c)<0&&(t[c]=e[c]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(c=Object.getOwnPropertySymbols(e);r<c.length;r++)n.indexOf(c[r])<0&&Object.prototype.propertyIsEnumerable.call(e,c[r])&&(t[c[r]]=e[c[r]])}return t},s=function(e,n,t){var c="react-spinners-".concat(e,"-").concat(t);if("undefined"==typeof window||!window.document)return c;var r=document.createElement("style");document.head.appendChild(r);var o=r.sheet,a="\n    @keyframes ".concat(c," {\n      ").concat(n,"\n    }\n  ");return o&&o.insertRule(a,0),c}("ClockLoader","100% { transform: rotate(360deg) }","rotate");var l=function(e){var n=e.loading,t=void 0===n||n,r=e.color,l=void 0===r?"#000000":r,u=e.speedMultiplier,d=void 0===u?1:u,h=e.cssOverride,p=void 0===h?{}:h,v=e.size,f=void 0===v?50:v,m=i(e,["loading","color","speedMultiplier","cssOverride","size"]),x=o(f),_=x.value,j=x.unit,g=a({display:"inherit",position:"relative",width:"".concat(_).concat(j),height:"".concat(_).concat(j),backgroundColor:"transparent",boxShadow:"inset 0px 0px 0px 2px ".concat(l),borderRadius:"50%"},p),b={position:"absolute",backgroundColor:l,width:"".concat(_/3,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(8/d,"s linear infinite")},y={position:"absolute",backgroundColor:l,width:"".concat(_/2.4,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(2/d,"s linear infinite")};return t?c.createElement("span",a({style:g},m),c.createElement("span",{style:y}),c.createElement("span",{style:b})):null}},9536:function(e,n,t){var c=t(6811),r=t(184);n.Z=(0,c.Z)((0,r.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline")}}]);
//# sourceMappingURL=703.a3f08228.chunk.js.map