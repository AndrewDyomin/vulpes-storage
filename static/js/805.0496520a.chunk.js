"use strict";(self.webpackChunkvulpes_storage=self.webpackChunkvulpes_storage||[]).push([[805],{1448:function(e,n,t){t.d(n,{m:function(){return f}});var r=t(5861),c=t(9439),a=t(4687),o=t.n(a),i=t(2791),s={container:"BarcodeScanner_container__zdOxt",scanBlock:"BarcodeScanner_scanBlock__MR5A0",videoArea:"BarcodeScanner_videoArea__AA2r4",hide:"BarcodeScanner_hide__qqbBN",modalArea:"BarcodeScanner_modalArea__9PFQN",modalImage:"BarcodeScanner_modalImage__0uUA6",button:"BarcodeScanner_button__kNses"},l=t(1089),u=t(5612),d=t(4420),v=t(9654),p=t(9230),h=t(184),f=(0,i.forwardRef)((function(e,n){var t=e.setLastResult,a=(0,p.$G)().t,f=(0,d.I0)(),m=(0,d.v9)(v.K),x=(0,i.useRef)(null),_=(0,i.useRef)(null),j=(0,i.useState)([]),y=(0,c.Z)(j,2),k=y[0],b=y[1],g=(0,i.useState)(""),C=(0,c.Z)(g,2),N=C[0],I=C[1],Z=(0,i.useState)(null),S=(0,c.Z)(Z,2),w=S[0],B=S[1],D=(0,i.useState)(!1),A=(0,c.Z)(D,2),O=A[0],R=A[1],P=(0,i.useRef)(new l.BrowserMultiFormatReader);(0,i.useEffect)((function(){var e=P.current;return navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return e.listVideoInputDevices()})).then((function(e){b(e),e.length>0&&I(e[0].deviceId)})).catch((function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435:",e)})),function(){e.reset()}}),[]),(0,i.useImperativeHandle)(n,(function(){return{startScan:E,stopScan:F}}));var E=function(){R(!0),N&&P.current.decodeFromVideoDevice(N,x.current,function(){var e=(0,r.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n)try{"H"!==(null===n||void 0===n?void 0:n.text[0])&&(t(n.text),f((0,u.BD)(n.text)))}catch(r){console.error(r),B({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443"})}case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}())},F=function(){R(!1),P.current.reset(),B(null)};return(0,i.useEffect)((function(){m&&m.article&&F(),null===m&&F()}),[m,w]),(0,h.jsxs)("div",{className:s.container,children:[(0,h.jsx)("div",{className:s.scanBlock,children:(0,h.jsx)("video",{ref:x,className:O?s.videoArea:s.hide})}),(0,h.jsxs)("div",{className:s.buttonsBlock,children:[(0,h.jsx)("button",{className:s.button,onClick:E,children:a("start")}),(0,h.jsx)("button",{className:s.button,onClick:F,children:a("reset")})]}),(0,h.jsxs)("div",{className:s.scanBlock,children:[(0,h.jsxs)("label",{htmlFor:"sourceSelect",children:[a("change video source"),":"]}),(0,h.jsx)("select",{ref:_,id:"sourceSelect",value:N,onChange:function(e){return I(e.target.value)},children:k.map((function(e){return(0,h.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(e.deviceId)},e.deviceId)}))})]})]})}))},381:function(e,n,t){t.d(n,{N:function(){return l}});var r=t(3439),c=t(7948),a=t.n(c),o="PopUp_modalCloseButton__m06-1",i="PopUp_menuIcon__5-11v",s=t(184),l=function(e){var n=e.isOpen,t=e.close,c=e.body;return(0,s.jsxs)(a(),{isOpen:n,onRequestClose:t,style:{overlay:{backgroundColor:"rgba(9, 9, 9, 0.75)",position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",minWidth:"300px",maxWidth:"80%",width:"auto",maxHeight:"80%",padding:"50px 20px",borderRadius:"12px",border:"2px solid black",backgroundColor:"FFF",transition:"top 0.3s ease-in-out"}},ariaHideApp:!1,children:[(0,s.jsx)("button",{className:o,type:"button",onClick:t,children:(0,s.jsx)("svg",{className:i,children:(0,s.jsx)("use",{href:"".concat(r.Z,"#icon-close-circle")})})}),c]})}},9805:function(e,n,t){t.r(n),t.d(n,{default:function(){return K}});var r=t(7762),c=t(3433),a=t(5861),o=t(9439),i=t(4687),s=t.n(i),l=t(4420),u=t(2791),d=t(9567),v=t(9654),p=t(4723),h=t(6811),f=t(184),m=(0,h.Z)((0,f.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz"),x=t(9536),_=t(5294),j=t(5218),y=t(381),k=t(1448),b="InventoryCheckDetails_titleArea__I-a9B",g="InventoryCheckDetails_moreButton__V3hyh",C="InventoryCheckDetails_list__JobJk",N="InventoryCheckDetails_item__XUJON",I="InventoryCheckDetails_itemImage__CLNXX",Z="InventoryCheckDetails_itemArticle__VHXCd",S="InventoryCheckDetails_itemCount__SNtz3",w="InventoryCheckDetails_itemCountInput__DURP1",B="InventoryCheckDetails_moreModal__kGGDn",D="InventoryCheckDetails_modalButton__tt1J8",A="InventoryCheckDetails_delButton__oPsgy",O="InventoryCheckDetails_editButtons__75Qai",R="InventoryCheckDetails_addButton__wRCZC",P="InventoryCheckDetails_saveBtnWrapper__lZM3-",E="InventoryCheckDetails_saveButton__aYaVG",F="InventoryCheckDetails_scanButton__HCnIa",H="InventoryCheckDetails_modalArea__-4JMX",M="InventoryCheckDetails_modalImage__dUBSg",U="InventoryCheckDetails_countArea__Clfwh",V="InventoryCheckDetails_countInput__HCLuM",z="InventoryCheckDetails_countAddBtn__m1Hms",q="InventoryCheckDetails_notFoundArea__qYXDF",L=t(9230),X=function(e){var n,t,i,h=e.id,X=(0,L.$G)().t,G=(0,l.I0)(),J=(0,l.v9)(d.W),W=(0,l.v9)(v.K),K=(0,u.useRef)(),$=J.find((function(e){return e._id===h})),Q=(0,u.useState)([]),Y=(0,o.Z)(Q,2),T=Y[0],ee=Y[1],ne=(0,u.useState)(!1),te=(0,o.Z)(ne,2),re=te[0],ce=te[1],ae=(0,u.useState)(!1),oe=(0,o.Z)(ae,2),ie=oe[0],se=oe[1],le=(0,u.useState)(!1),ue=(0,o.Z)(le,2),de=ue[0],ve=ue[1],pe=(0,u.useState)(!1),he=(0,o.Z)(pe,2),fe=he[0],me=he[1],xe=(0,u.useState)([]),_e=(0,o.Z)(xe,2),je=_e[0],ye=_e[1],ke=(0,u.useState)(!1),be=(0,o.Z)(ke,2),ge=be[0],Ce=be[1],Ne=(0,u.useState)(""),Ie=(0,o.Z)(Ne,2),Ze=Ie[0],Se=Ie[1],we=(0,u.useState)(),Be=(0,o.Z)(we,2),De=Be[0],Ae=Be[1],Oe=(0,u.useState)(),Re=(0,o.Z)(Oe,2),Pe=Re[0],Ee=Re[1],Fe=function(){var e=(0,a.Z)(s().mark((function e(n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.Z.post("/products/byarticle",{article:n});case 2:return t=e.sent,e.abrupt("return",t.data.product);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),He=function(){ce(!1),se(!1),ve(!1)},Me=function(){var e=(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.Z.post("/inventory-check/delete",{id:h});case 3:j.ZP.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0443\u0434\u0430\u043b\u0451\u043d"),He(),window.history.back(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438:",e.t0.message),j.ZP.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:$._id,items:[]},je.forEach((function(e,t){var r=document.getElementById("".concat(t,"Count")),c=r?Number(r.value):0,a=""!==e.article?e.article:document.getElementById("".concat(t,"Article")).value;n.items.push({article:a,count:c})})),e.prev=2,e.next=5,_.Z.post("/inventory-check/update",n);case 5:j.ZP.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0451\u043d"),window.history.back(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),j.ZP.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e;ye((function(e){return[].concat((0,c.Z)(e),[{article:Pe||W.article,count:De}])})),ve(!1),Ee(),Ae(),G((0,p.h)()),null===(e=K.current)||void 0===e||e.startScan()};return(0,u.useEffect)((function(){var e;if($&&null!==(e=$.items)&&void 0!==e&&e.length){var n=function(){var e=(0,a.Z)(s().mark((function e(){var n,t,c,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t=(0,r.Z)($.items),e.prev=2,t.s();case 4:if((c=t.n()).done){e.next=18;break}return a=c.value,e.prev=6,e.next=9,Fe(a.article);case 9:o=e.sent,n.push(o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0430 ".concat(a.article,":"),e.t0.message);case 16:e.next=4;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(2),t.e(e.t1);case 23:return e.prev=23,t.f(),e.finish(23);case 26:ee(n);case 27:case"end":return e.stop()}}),e,null,[[2,20,23,26],[6,13]])})));return function(){return e.apply(this,arguments)}}();n()}}),[$]),(0,u.useEffect)((function(){""!==Ze&&(W&&W.article&&ve(!0),null===W&&ve(!0))}),[W,Ze]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:b,children:[(0,f.jsx)("h1",{children:null===$||void 0===$?void 0:$.name}),(0,f.jsx)("button",{className:g,onClick:function(){return ce(!0)},children:(0,f.jsx)(m,{fontSize:"large"})})]}),ge&&(0,f.jsx)("div",{children:(0,f.jsx)(k.m,{setLastResult:Se,ref:K})}),(0,f.jsxs)("p",{children:[X("items"),":"]}),(0,f.jsx)("ul",{className:C,children:null===(n=fe?je:$.items)||void 0===n?void 0:n.map((function(e,n){var t,r=T.find((function(n){return(null===n||void 0===n?void 0:n.article)===e.article}));return(0,f.jsxs)("li",{className:N,children:[(0,f.jsx)("img",{className:I,alt:null===r||void 0===r||null===(t=r.name)||void 0===t?void 0:t.UA,src:null===r||void 0===r?void 0:r.images[0]}),fe&&""===e.article?(0,f.jsx)("input",{id:"".concat(n,"Article"),placeholder:X("article"),className:Z}):(0,f.jsxs)("p",{className:Z,children:[X("article"),": ",e.article]}),fe?(0,f.jsx)("input",{id:"".concat(n,"Count"),defaultValue:e.count,placeholder:X("count"),className:"".concat(S," ").concat(w)}):(0,f.jsxs)("p",{className:S,children:[e.count," ",X("pcs"),"."]})]},n)}))}),fe&&(0,f.jsxs)("div",{className:O,children:[(0,f.jsx)("button",{className:R,onClick:function(){ye((function(e){return[].concat((0,c.Z)(e),[{article:"",count:""}])}))},children:(0,f.jsx)(x.Z,{fill:"transparent",fontSize:"large"})}),(0,f.jsxs)("div",{className:P,children:[(0,f.jsx)("button",{className:E,onClick:Ue,children:X("save")}),(0,f.jsx)("button",{className:"".concat(E," ").concat(F),onClick:function(){Ce(!0)},children:X("scan")})]})]}),(0,f.jsx)(y.N,{isOpen:re,close:He,body:(0,f.jsxs)("div",{className:B,children:[(0,f.jsx)("button",{className:D,onClick:function(){ye((0,c.Z)($.items)),me(!0),He()},children:X("edit")}),(0,f.jsx)("button",{className:"".concat(D," ").concat(A),onClick:function(){return se(!0)},children:X("delete")})]})}),(0,f.jsx)(y.N,{isOpen:ie,close:He,body:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("p",{children:[X("are you sure"),"?"]}),(0,f.jsxs)("div",{className:B,children:[(0,f.jsx)("button",{className:D,onClick:He,children:X("cancel")}),(0,f.jsx)("button",{className:"".concat(D," ").concat(A),onClick:Me,children:X("delete")})]})]})}),(0,f.jsx)(y.N,{isOpen:de,close:He,body:W&&W.article?(0,f.jsxs)("div",{className:H,children:[Array.isArray(W.images)&&W.images.length>0?(0,f.jsx)("img",{className:M,alt:"scanned product",src:W.images[0]}):(0,f.jsx)("p",{children:"No image"}),(0,f.jsx)("p",{children:"".concat((null===(t=W.name)||void 0===t?void 0:t.UA)||X("no name")," (").concat(W.article,")")}),(0,f.jsx)("p",{children:null!==(i=W.price)&&void 0!==i&&i.UAH?"".concat(W.price.UAH," \u0433\u0440\u043d."):"\u0426\u0435\u043d\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430"}),(0,f.jsxs)("div",{className:U,children:[(0,f.jsx)("input",{placeholder:X("count"),onChange:function(e){return Ae(e.target.value)},defaultValue:De,className:V,type:"number"}),(0,f.jsx)("button",{className:z,onClick:Ve,children:X("add")})]})]}):null===W?(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{children:X("product not found")}),(0,f.jsxs)("p",{children:[X("barcode"),": ",Ze]}),(0,f.jsxs)("div",{className:"".concat(U," ").concat(q),children:[(0,f.jsx)("input",{placeholder:X("article"),onChange:function(e){return Ee(e.target.value)},defaultValue:Pe,className:V}),(0,f.jsx)("input",{placeholder:X("count"),onChange:function(e){return Ae(e.target.value)},defaultValue:De,className:V,type:"number"}),(0,f.jsx)("button",{className:z,onClick:Ve,children:X("add")})]})]}):null})]})},G=t(3050),J=t(7689),W=t(4270);function K(){var e=(0,l.v9)(d.N),n=(0,J.UO)().inventoryId;return(0,f.jsx)(G.B6,{children:(0,f.jsxs)("div",{children:[(0,f.jsx)(G.ql,{children:(0,f.jsx)("title",{children:"Inventory check details"})}),e?(0,f.jsx)(W.Z,{color:"#c04545"}):(0,f.jsx)(X,{id:n})]})})}},9567:function(e,n,t){t.d(n,{N:function(){return c},W:function(){return r}});var r=function(e){return e.inventory.items},c=function(e){return e.inventory.isLoading}},9654:function(e,n,t){t.d(n,{K:function(){return c},q:function(){return r}});var r=function(e){return e.products.items},c=function(e){return e.products.activeItem}},4270:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(2791),c={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function a(e){if("number"===typeof e)return{value:e,unit:"px"};var n,t=(e.match(/^[0-9.]*/)||"").toString();n=t.includes(".")?parseFloat(t):parseInt(t,10);var r=(e.match(/[^0-9]*$/)||"").toString();return c[r]?{value:n,unit:r}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(n,"px.")),{value:n,unit:"px"})}var o=function(){return o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var c in n=arguments[t])Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c]);return e},o.apply(this,arguments)},i=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var c=0;for(r=Object.getOwnPropertySymbols(e);c<r.length;c++)n.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(e,r[c])&&(t[r[c]]=e[r[c]])}return t},s=function(e,n,t){var r="react-spinners-".concat(e,"-").concat(t);if("undefined"==typeof window||!window.document)return r;var c=document.createElement("style");document.head.appendChild(c);var a=c.sheet,o="\n    @keyframes ".concat(r," {\n      ").concat(n,"\n    }\n  ");return a&&a.insertRule(o,0),r}("ClockLoader","100% { transform: rotate(360deg) }","rotate");var l=function(e){var n=e.loading,t=void 0===n||n,c=e.color,l=void 0===c?"#000000":c,u=e.speedMultiplier,d=void 0===u?1:u,v=e.cssOverride,p=void 0===v?{}:v,h=e.size,f=void 0===h?50:h,m=i(e,["loading","color","speedMultiplier","cssOverride","size"]),x=a(f),_=x.value,j=x.unit,y=o({display:"inherit",position:"relative",width:"".concat(_).concat(j),height:"".concat(_).concat(j),backgroundColor:"transparent",boxShadow:"inset 0px 0px 0px 2px ".concat(l),borderRadius:"50%"},p),k={position:"absolute",backgroundColor:l,width:"".concat(_/3,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(8/d,"s linear infinite")},b={position:"absolute",backgroundColor:l,width:"".concat(_/2.4,"px"),height:"2px",top:"".concat(_/2-1,"px"),left:"".concat(_/2-1,"px"),transformOrigin:"1px 1px",animation:"".concat(s," ").concat(2/d,"s linear infinite")};return t?r.createElement("span",o({style:y},m),r.createElement("span",{style:b}),r.createElement("span",{style:k})):null}},9536:function(e,n,t){var r=t(6811),c=t(184);n.Z=(0,r.Z)((0,c.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline")}}]);
//# sourceMappingURL=805.0496520a.chunk.js.map